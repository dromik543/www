<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Jarvis ‚Äî pastelov√Ω AI asistent</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
<style>
  :root{
    --pink:#ffd6e8;
    --yellow:#fff7c2;
    --blue:#dff4ff;
    --glass: rgba(255,255,255,0.75);
    --accent:#ff8ac0;
    --muted:#555;
    --radius:18px;
  }
  *{box-sizing:border-box}
  body{
    font-family:"Poppins",system-ui,Segoe UI,Roboto,Arial;
    margin:0;
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    background: linear-gradient(135deg,var(--pink),var(--yellow),var(--blue));
    padding:28px;
  }

  .card{
    width:100%;
    max-width:920px;
    background:var(--glass);
    border-radius:24px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.12);
    overflow:hidden;
    display:grid;
    grid-template-columns: 320px 1fr;
    gap:0;
  }

  /* left panel - Jarvis info */
  .left{
    padding:22px;
    background: linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.5));
    border-right: 1px solid rgba(0,0,0,0.03);
  }
  .avatar{
    width:120px;
    height:120px;
    margin:0 auto 12px;
    border-radius:20px;
    background: linear-gradient(135deg,#ffeaf4,#e3f4ff);
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:700;
    color:var(--accent);
    font-size:34px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.06);
  }
  h2{ text-align:center; margin:10px 0 6px; color:#ff6ea8; }
  p.desc{ text-align:center; font-size:14px; color:var(--muted); margin:0 0 16px; }
  .controls{ display:flex; gap:8px; flex-wrap:wrap; justify-content:center; }
  .btn{
    background:white; border-radius:12px; padding:8px 12px; border:none; cursor:pointer;
    box-shadow: 0 6px 18px rgba(0,0,0,0.04); font-weight:600;
  }
  .btn.talk{ background:linear-gradient(90deg,#ffd6e8,#dff4ff); color:#333 }
  .small{ font-size:13px; color:#666; text-align:center; margin-top:14px }

  /* right panel - chat */
  .right{ display:flex; flex-direction:column; height:600px; }
  .header{
    padding:18px 18px; display:flex; gap:12px; align-items:center;
    background: linear-gradient(90deg, rgba(255,255,255,0.8), rgba(255,255,255,0.65));
    border-bottom:1px solid rgba(0,0,0,0.04);
  }
  .status{
    width:10px; height:10px; border-radius:50%; background:#8affc1; box-shadow:0 0 6px #8affc1;
  }
  .header h3{ margin:0; color:#444; font-size:18px; }
  .chat{
    padding:18px;
    overflow:auto;
    background: linear-gradient(180deg, rgba(255,255,255,0.4), rgba(255,255,255,0.2));
    flex:1;
  }
  .msg{ max-width:76%; margin:8px 0; padding:12px 14px; border-radius:14px; line-height:1.35; }
  .msg.user{ margin-left:auto; background: linear-gradient(90deg,#fff,#ffeef8); border:1px solid rgba(255,138,176,0.14) }
  .msg.jarvis{ background: linear-gradient(90deg,#f0fbff,#fffbe6); border:1px solid rgba(109,169,255,0.16); color:#1a364a }
  .meta{ font-size:11px; color:#666; margin-top:6px; }

  .composer{
    padding:12px;
    display:flex;
    gap:10px;
    border-top:1px solid rgba(0,0,0,0.04);
    background: rgba(255,255,255,0.6);
  }
  .composer input{
    flex:1; padding:12px 14px; border-radius:12px; border:1px solid rgba(0,0,0,0.06);
    font-size:15px;
  }
  .composer button{ padding:10px 14px; border-radius:12px; border:none; cursor:pointer; font-weight:700; background:linear-gradient(90deg,#ffd6e8,#dff4ff) }

  /* small responsive */
  @media (max-width:880px){
    .card{ grid-template-columns: 1fr; }
    .left{ order:2 }
    .right{ order:1; height:640px }
  }
</style>
</head>
<body>

<div class="card" role="application" aria-label="Jarvis pastel chatbot">
  <aside class="left">
    <div class="avatar" id="avatar">J</div>
    <h2 id="jarvis-name">Jarvis</h2>
    <p class="desc">Tv≈Øj pastelov√Ω AI pomocn√≠k ‚Äî klidnƒõ se na mƒõ zeptej cokoliv :)</p>

    <div class="controls">
      <button class="btn talk" id="toggle-speak">üîä Mluvit</button>
      <button class="btn" id="clear">üßπ Vymazat chat</button>
      <button class="btn" id="save">üíæ Ulo≈æit konverzaci</button>
    </div>

    <p class="small">Tip: napi≈° "vymysli p≈ô√≠bƒõh" nebo "zahraj si hru". Jm√©no Jarvis m≈Ø≈æe≈° zmƒõnit p≈ô√≠mo v k√≥du.</p>
  </aside>

  <section class="right">
    <div class="header">
      <div class="status" title="online"></div>
      <h3>Jarvis ‚Äî Pastelov√Ω pomocn√≠k</h3>
    </div>

    <div class="chat" id="chat" aria-live="polite">
      <!-- zpr√°vy se vkl√°daj√≠ sem -->
    </div>

    <div class="composer">
      <input id="input" placeholder="Napi≈° sem ot√°zku nebo p≈ô√≠kaz... (nap≈ô. Ahoj, vymysli p≈ô√≠bƒõh)" autocomplete="off" />
      <button id="send">Odeslat</button>
    </div>
  </section>
</div>

<script>
/* =============== jednoduch√© "AI" pravidlov√© odpovƒõdi =============== */

const jarvisName = "Jarvis"; // zmƒõ≈à pokud chce≈° jin√© jm√©no
const chatEl = document.getElementById('chat');
const inputEl = document.getElementById('input');
const sendBtn = document.getElementById('send');
const clearBtn = document.getElementById('clear');
const saveBtn = document.getElementById('save');
const toggleSpeakBtn = document.getElementById('toggle-speak');

let speakEnabled = false;
let voice = null;

// inicializace mluven√≠ (pokud podporov√°no)
function initSpeech(){
  if(!('speechSynthesis' in window)) return;
  const voices = speechSynthesis.getVoices();
  if (voices.length) voice = voices.find(v=>v.lang.startsWith('cs')) || voices[0];
}
initSpeech();
if (typeof speechSynthesis !== 'undefined') {
  speechSynthesis.onvoiceschanged = initSpeech;
}

// ulo≈æit/naƒç√≠st chat z localStorage
function loadChat(){
  const saved = localStorage.getItem('jarvis_chat_v1');
  if(saved){
    const msgs = JSON.parse(saved);
    msgs.forEach(m => appendMessage(m.text, m.who, false));
  } else {
    appendMessage('Ahoj! Jmenuji se ' + jarvisName + ' ‚Äî co pro tebe m≈Ø≈æu udƒõlat dnes? üòä', 'jarvis', false);
  }
}
function saveChat(){
  const msgs = Array.from(chatEl.querySelectorAll('.msg')).map(el=>{
    return { who: el.dataset.who, text: el.querySelector('.bubble')?.innerText || el.innerText };
  });
  localStorage.setItem('jarvis_chat_v1', JSON.stringify(msgs));
  alert('Konverzace ulo≈æena do prohl√≠≈æeƒçe.');
}

function clearChat(){
  if(confirm('Opravdu chce≈° vymazat konverzaci?')) {
    chatEl.innerHTML = '';
    localStorage.removeItem('jarvis_chat_v1');
    appendMessage('Chat byl vymaz√°n. Ahoj znovu! üòä', 'jarvis', false);
  }
}

// p≈ôid√°n√≠ zpr√°vy do UI
function appendMessage(text, who='jarvis', scroll=true){
  const div = document.createElement('div');
  div.className = 'msg ' + (who==='user' ? 'user' : 'jarvis');
  div.dataset.who = who;
  div.innerHTML = '<div class="bubble">'+escapeHtml(text)+'</div>';
  chatEl.appendChild(div);
  if(scroll) chatEl.scrollTop = chatEl.scrollHeight;
  if(who==='jarvis' && speakEnabled) speak(text);
}

// jednoduch√© escape
function escapeHtml(s){ return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }

// ≈ôe≈°en√≠ vstupu u≈æivatele
function handleInput(raw){
  const text = raw.trim();
  if(!text) return;
  appendMessage(text,'user');

  // jednoduch√© "porozumƒõn√≠"
  const t = text.toLowerCase().replace(/[^\w\s√°ƒçƒè√©ƒõ√≠≈à√≥≈ô≈°≈•√∫≈Ø√Ω≈æ√º√∂√§]+/g,'').trim();

  // kl√≠ƒçov√© fr√°ze:
  if(/^(ahoj|ƒçau|nazdar|servus|hello|hi)\b/.test(t)){
    replyRandom([
      'Ahoj! Jak ti mohu pomoci? üí´',
      'ƒåau! Co bys dnes chtƒõla dƒõlat?',
      'Ahoj, jsem tady pro tebe!'
    ]);
    return;
  }

  if(t.includes('jak se mas') || t.includes('jak se m√°≈°')){
    replyRandom(['M√°m se skvƒõle, d√≠ky! üòä A ty?','Jsem p≈ôipraven√Ω ti pomoci ‚Äî co m√°≈° na srdci?']);
    return;
  }

  if(t.includes('kdo jsi') || t.includes('kdo jsi?') || t.includes('kdo jsis')){
    appendMessage(`Jsem ${jarvisName} ‚Äî tv≈Øj pastelov√Ω AI pomocn√≠k. M≈Ø≈æu ti pom√°hat s n√°pady, psan√≠m p≈ô√≠bƒõh≈Ø, hr√°t hru nebo vymyslet motivaƒçn√≠ vƒõtu.`, 'jarvis');
    return;
  }

  if(t.includes('vymysli p≈ô√≠bƒõh') || t.includes('vymysli pribeh') || t.includes('p≈ô√≠bƒõh')){
    generateStory();
    return;
  }

  if(t.includes('zahraj') || t.includes('hra') || t.includes('hru')){
    playMiniGame();
    return;
  }

  if(t.includes('pomoz') || t.includes('help') || t.includes('porad')){
    appendMessage('≈òekni mi s ƒç√≠m pot≈ôebuje≈° pomoct ‚Äî ≈°kolou, n√°padem na p≈ô√≠bƒõh, nebo t≈ôeba receptem bez masa?', 'jarvis');
    return;
  }

  if(t.includes('vtip') || t.includes('pobav') || t.includes('rozvesel')){
    replyRandom(['Proƒç program√°tor nos√≠ br√Ωle? Proto≈æe nevid√≠ C#! ü§ì', 'Co udƒõl√° kniha v mo≈ôi? - Plaveƒçek! (lol)']);
    return;
  }

  if(t.includes('diky') || t.includes('dƒõkuju') || t.includes('d√≠ky')){
    appendMessage('R√°do se stalo! Kdykoliv üòä', 'jarvis');
    return;
  }

  // pokud nerozum√≠ ‚Äî nab√≠dne mo≈ænosti
  appendMessage('Hm‚Ä¶ to jsem √∫plnƒõ nepochopil. M≈Ø≈æu:\n‚Ä¢ vymyslet p≈ô√≠bƒõh\n‚Ä¢ zahr√°t mini hru\n‚Ä¢ vygenerovat hezkou zpr√°vu\nNapi≈° nap≈ô. "vymysli p≈ô√≠bƒõh" nebo "vtip".', 'jarvis');
}

// n√°hodn√° odpovƒõƒè z pole
function replyRandom(arr){ const r = arr[Math.floor(Math.random()*arr.length)]; appendMessage(r,'jarvis'); }

// jednoduch√Ω generator kr√°tk√©ho p≈ô√≠bƒõhu
function generateStory(){
  const starts = [
    'Za mƒõstem le≈æelo mal√© mƒõsteƒçko, kde v noci tanƒçily svƒõtlu≈°ky.',
    'Na vrcholu hory st√°la d√≠vka se st≈ô√≠brn√Ωmi vlasy a tajemn√Ωm amuletem.',
    'V hlubin√°ch star√©ho lesa se probudil star√Ω stroj, kter√Ω umƒõl vypr√°vƒõt sny.'
  ];
  const middles = [
    'Jednoho dne na≈°la mapu, kter√° ji zavedla k zapomenut√©mu mƒõs√≠ƒçn√≠mu jezeru.',
    'Setkala se s moudrou sovou, kter√° j√≠ ≈ôekla, ≈æe v ka≈æd√©m srdci je svƒõtlo.',
    'Spolu se sv√Ωmi p≈ô√°teli vytvo≈ôili pl√°n, jak zachr√°nit ztracen√© p√≠snƒõ.'
  ];
  const ends = [
    'A tak se stalo, ≈æe z mal√©ho ƒçinu vyrostl nov√Ω svƒõt a oni se stali jeho str√°≈æci.',
    'Nakonec na≈°la domov tam, kde se sm√≠ch a odvaha potkaly ‚Äî a nikdy nezapomnƒõla.',
    'A i kdy≈æ cesta konƒçila, zaƒçalo nƒõco nov√©ho ‚Äî dobrodru≈æstv√≠, kter√© nikdy nekonƒç√≠.'
  ];
  const story = `${starts.random()} ${middles.random()} ${ends.random()}`;
  appendMessage(story,'jarvis');
}

// mini hra: h√°dej ƒç√≠slo 1-10
function playMiniGame(){
  appendMessage('OK ‚Äî hra: H√°dej ƒç√≠slo od 1 do 10. Napi≈° ƒç√≠slo (pokus m√°≈° 3x).', 'jarvis');
  startGuessingGame();
}

/* ---------------- HELPERS pro hru h√°dej ƒç√≠slo ---------------- */
let guessing = false;
let target = 0;
let tries = 0;
function startGuessingGame(){
  guessing = true;
  target = Math.floor(Math.random()*10)+1;
  tries = 0;
  // naslouch√°me na glob√°ln√≠ vstup: p≈ôi dal≈°√≠m odesl√°n√≠ zpracujeme h√°d√°n√≠
}

function handleGuessAttempt(text){
  if(!guessing) return false;
  const n = parseInt(text.trim());
  if(isNaN(n)) { appendMessage('Napi≈° pros√≠m ƒç√≠slo mezi 1 a 10.', 'jarvis'); return true; }
  tries++;
  if(n === target){
    appendMessage(`Super! Uhodla jsi ƒç√≠slo ${target} üéâ`, 'jarvis');
    guessing = false;
  } else if(tries >= 3){
    appendMessage(`Uff, nevy≈°lo to ‚Äî spr√°vn√© ƒç√≠slo bylo ${target}. Zkusme znovu pozdƒõji!`, 'jarvis');
    guessing = false;
  } else {
    appendMessage(n < target ? 'Moc n√≠zko ‚Äî zkus vƒõt≈°√≠ ƒç√≠slo.' : 'Moc vysoko ‚Äî zkus men≈°√≠ ƒç√≠slo.', 'jarvis');
  }
  return true;
}

/* ---------------- utility: n√°hodn√© vol√°n√≠ ---------------- */
Array.prototype.random = function(){ return this[Math.floor(Math.random()*this.length)]; };

/* =============== UI eventy =============== */

sendBtn.addEventListener('click', () => {
  const text = inputEl.value;
  inputEl.value = '';
  // pokud hra aktivn√≠ -> zpracovat h√°d√°n√≠
  if(guessing){
    const consumed = handleGuessAttempt(text);
    if(!consumed) handleInput(text);
  } else {
    handleInput(text);
  }
});

inputEl.addEventListener('keydown', (e)=>{
  if(e.key === 'Enter') sendBtn.click();
});

// clear / save buttons
clearBtn.addEventListener('click', clearChat);
saveBtn.addEventListener('click', saveChat);

// toggle mluven√≠
toggleSpeakBtn.addEventListener('click', ()=>{
  speakEnabled = !speakEnabled;
  toggleSpeakBtn.textContent = speakEnabled ? 'üîá Vypnout mluven√≠' : 'üîä Mluvit';
});

// jednoduch√© text-to-speech
function speak(text){
  if(!('speechSynthesis' in window)) return;
  if(!voice) initSpeech();
  const u = new SpeechSynthesisUtterance(text);
  if(voice) u.voice = voice;
  u.lang = voice?.lang || 'cs-CZ';
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}

// p≈ôi zav≈ôen√≠ ulo≈æ√≠me
window.addEventListener('beforeunload', saveChat);

// naƒç√≠st ulo≈æen√Ω chat
loadChat();

/* ---------- mal√© zlep≈°en√≠: pokud u≈æivatel nap√≠≈°e nƒõco nezn√°m√©ho, Jarvis nab√≠dne tipy ---------- */
(function enhanceUnknownReply(){
  const original = appendMessage;
  // nen√≠ pot≈ôeba p≈ôepisovat mnoho, u≈æ m√°me fallbacky v handleInput
})();

</script>
</body>
</html>
